library(DESeq2)
data<- read.table ("Coho_counts.txt", header=T)
View(data)
rownames(data) <- data$target_id
deseq2.colData <- data.frame(condition=factor(c(rep("Coulter", 6), rep("Issaquah", 6),
rep("Jenkins",6), rep("Swamp",6))),
type=factor(rep("paired-end", 24)))
View(deseq2.colData)
rownames(deseq2.colData) <- colnames(data)
View(deseq2.colData)
View(data)
View(deseq2.colData)
View(data)
data[,-1]
View(data)
View(data)
data[,-1]
data<-data[,-1]
View(deseq2.colData)
rownames(deseq2.colData) <- colnames(data)
View(deseq2.colData)
deseq2.dds <- DESeqDataSetFromMatrix(countData = data,
colData = deseq2.colData,
design = ~ condition)
deseq2.dds <- DESeq(deseq2.dds)
View(data)
View(deseq2.colData)
View(data)
View(deseq2.colData)
View(data)
data<- read.table ("Coho_counts.txt", header=T)
rownames(data) <- data$target_id
data<-data[,-1]
deseq2.colData <- data.frame(condition=factor(c(rep("Coulter", 6), rep("Issaquah", 6),
rep("Jenkins",6), rep("Swamp",6))),
type=factor(rep("paired-end", 24)))
rownames(deseq2.colData) <- colnames(data)
deseq2.dds <- DESeqDataSetFromMatrix(countData = data,
colData = deseq2.colData,
design = ~ condition)
deseq2.dds <- DESeq(deseq2.dds)
deseq2.res <- results(deseq2.dds)
deseq2.res <- deseq2.res[order(rownames(deseq2.res)), ]
head(deseq2.res, n=30)
dim(deseq2.res[!is.na(deseq2.res$padj) & deseq2.res$padj <= 0.05, ])
tmp <- deseq2.res
# The main plot
plot(tmp$baseMean, tmp$log2FoldChange, pch=20, cex=0.45, ylim=c(-3, 3), log="x", col="darkgray",
main="DEG Virus Exposure  (pval <= 0.05)",
xlab="mean of normalized counts",
ylab="Log2 Fold Change")
sig<-deseq2.res[!is.na(deseq2.res$padj) & deseq2.res$padj <= 0.05, ]
head(sig)
write.table(sig, file="sig.txt")
source("https://bioconductor.org/biocLite.R")
biocLite("pcaExplorer")
pcaExplorer(dds = dds, rlt = rlt)
biocLite("pcaExplorer")
library("devtools")
install_github("federicomarini/pcaExplorer")
source("http://bioconductor.org/biocLite.R")
install.packages("Hmisc")
?deseq2
?DESeq
?results
data<- read.table ("Coho_counts.txt", header=T)
rownames(data) <- data$target_id
data<-data[,-1]
deseq2.colData <- data.frame(condition=factor(c(rep("Coulter", 6), rep("Issaquah", 6),
rep("Jenkins",6), rep("Swamp",6))),
type=factor(rep("paired-end", 24)))
rownames(deseq2.colData) <- colnames(data)
deseq2.dds <- DESeqDataSetFromMatrix(countData = data,
colData = deseq2.colData,
design = ~ condition)
deseq2.dds <- DESeqDataSetFromMatrix(countData = data,
colData = deseq2.colData,
design = ~ condition)
library(DESeq2)
deseq2.dds <- DESeqDataSetFromMatrix(countData = data,
colData = deseq2.colData,
design = ~ condition)
deseq2.dds <- DESeq(deseq2.dds)
deseq2.IssCoulterres <- results(deseq2.dds, contrast = c("Coulter", "Issaquah"))
deseq2.IssCoulterres <- results(deseq2.dds, contrast = c("Condition", "Coulter", "Issaquah"))
deseq2.IssCoulterres <- results(deseq2.dds, contrast = c("condition", "Coulter", "Issaquah"))
deseq2.res <- deseq2.res[order(rownames(deseq2.res)), ]
deseq2.JenkCoultres<- results (seseq2.dds, contrast = c("condition", "Coulter", "Jenkins",))
deseq2.JenkCoultres<- results (deseq2.dds, contrast = c("condition", "Coulter", "Jenkins",))
deseq2.JenkCoultres<- results (deseq2.dds, contrast = c("condition", "Coulter", "Jenkins"))
deseq2.IssCoulterres <- deseq2.res[order(rownames(deseq2.IssCoulterres)), ]
deseq2.JenkCoultres<-deseq2.res[order(rownames(deseq2.JenkCoultres)),]
deseq2.SwampCoultres<-results(deseq2.dds, contrast = c("condition", "Coulter", "Swamp"))
deseq2.SwampCoultres<-deseq2.SwampCoulres[order(rownames(deseq2.SwampCoultres))]
deseq2.SwampCoultres<-results(deseq2.dds, contrast = c("condition", "Coulter", "Swamp"))
deseq2.SwampCoultres<-deseq2.SwampCoulres[order(rownames(deseq2.SwampCoultres))]
deseq2.SwampCoultres<-deseq2.SwampCoultres[order(rownames(deseq2.SwampCoultres))]
deseq2.SwampCoultres<-deseq2.SwampCoultres[order(rownames(deseq2.SwampCoultres)),]
dim(deseq2.IssCoulterres[!is.na(deseq2.IssCoulterres$padj) & deseq2.IssCoulterres$padj <= 0.05, ])
dim(deseq2.JenkCoultres[!is.na(deseq2.JenkCoultres$padj) & deseq2.JenkCoultres$padj <= 0.05, ])
dim(deseq2.SwampCoultres[!is.na(deseq2.SwampCoultres$padj) & deseq2.SwampCoultres$padj <=0.05,])
dim(deseq2.JenkCoultres[!is.na(deseq2.JenkCoultres$padj) & deseq2.JenkCoultres$padj <= 0.05,])
deseq2.JenkCoultres<-deseq2.res[order(rownames(deseq2.JenkCoultres)),]
dim(deseq2.JenkCoultres[!is.na(deseq2.JenkCoultres$padj) & deseq2.JenkCoultres$padj <= 0.05,])
dim(deseq2.IssCoulterres[!is.na(deseq2.IssCoulterres$padj) & deseq2.IssCoulterres$padj <= 0.05,])
