{
    "contents" : "source(\"https://bioconductor.org/biocLite.R\")\nbiocLite(\"DESeq2\")\nlibrary(DESeq2)\ndata<- read.table (\"Phel_countdata.txt\", header=T, sep =\"\\t\")\nrownames(data) <- data$Feature\ndata<-data[,-1]\ndeseq2.colData <- data.frame(condition=factor(c(rep(\"Treated\", 3), rep(\"Control\", 3))), \n                             type=factor(rep(\"single-read\", 6)))\nrownames(deseq2.colData) <- colnames(data)\ndeseq2.dds <- DESeqDataSetFromMatrix(countData = data,\n                                     colData = deseq2.colData, \n                                     design = ~ condition)\n\ndeseq2.dds <- DESeq(deseq2.dds)\ndeseq2.res <- results(deseq2.dds)\ndeseq2.res <- deseq2.res[order(rownames(deseq2.res)), ]\n\nhead(deseq2.res, n=30)\n\ndim(deseq2.res[!is.na(deseq2.res$padj) & deseq2.res$padj <= 0.05, ])\n\ntmp <- deseq2.res\n# The main plot\nplot(tmp$baseMean, tmp$log2FoldChange, pch=20, cex=0.45, ylim=c(-3, 3), log=\"x\", col=\"darkgray\",\n     main=\"DEG Virus Exposure  (pval <= 0.05)\",\n     xlab=\"mean of normalized counts\",\n     ylab=\"Log2 Fold Change\")\n# Getting the significant points and plotting them again so they're a different color\ntmp.sig <- deseq2.res[!is.na(deseq2.res$padj) & deseq2.res$padj <= 0.05, ]\npoints(tmp.sig$baseMean, tmp.sig$log2FoldChange, pch=20, cex=0.45, col=\"purple\")\n# 2 FC lines\nabline(h=c(-1,1), col=\"green\")\n\nhead(tmp)\nsig<-deseq2.res[!is.na(deseq2.res$padj) & deseq2.res$padj <= 0.05, ]\nhead(sig)\n?write.table\nwrite.table(sig, file=\"sig.txt\")\n",
    "created" : 1477490906191.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "557209412",
    "id" : "DCFAFC51",
    "lastKnownWriteTime" : 1477580663,
    "path" : "~/RNAseq_Coho/Week4quiz/r-analysis.R",
    "project_path" : null,
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "type" : "r_source"
}